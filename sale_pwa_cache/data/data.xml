<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <!-- POST -->
        <record id="pwa_cache_post_sale_order_onboarding_panel" model="pwa.cache">
            <field name="name">Sale Order - Post - Onboarding Panel</field>
            <field name="cache_type">post</field>
            <field name="post_url">sales/sale_quotation_onboarding_panel</field>
            <field name="internal">1</field>
        </record>

        <!-- GET -->
        <record id="pwa_cache_get_sale_order_onboarding_panel_bg" model="pwa.cache">
            <field name="name">Sale Order - Get - Onboarding Panel Background</field>
            <field name="cache_type">get</field>
            <field name="get_urls">sale/static/src/img/sale_quotation_onboarding_bg.jpg</field>
            <field name="internal">1</field>
        </record>
    </data>

    <data noupdate="1">

        <!-- MODEL -->
        <record id="pwa_cache_model_crm_team_all" model="pwa.cache">
            <field name="name">CRM Teams (All)</field>
            <field name="cache_type">model</field>
            <field name="model_id" ref="sales_team.model_crm_team"/>
            <field name="model_domain_raw">[]</field>
        </record>

        <record id="pwa_cache_model_uom_uom_all" model="pwa.cache">
            <field name="name">Units of Measure (All)</field>
            <field name="cache_type">model</field>
            <field name="model_id" ref="uom.model_uom_uom"/>
        </record>

        <record id="pwa_cache_model_sale_order_all" model="pwa.cache">
            <field name="name">Saler Orders (All - Last year)</field>
            <field name="cache_type">model</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="model_domain_raw">[['date_order', '&gt;', (context_today() - relativedelta(days=365)).strftime('%Y-%m-%d')]]</field>
        </record>

        <record id="pwa_cache_model_sale_order_lines_all" model="pwa.cache">
            <field name="name">Sale Order Lines (All - Last year)</field>
            <field name="cache_type">model</field>
            <field name="model_id" ref="sale.model_sale_order_line"/>
            <field name="model_domain_raw">[['order_id.date_order', '&gt;', (context_today() - relativedelta(days=365)).strftime('%Y-%m-%d')]]</field>
        </record>

        <record id="pwa_cache_model_account_tax_all" model="pwa.cache">
            <field name="name">Account Tax (All)</field>
            <field name="cache_type">model</field>
            <field name="model_id" ref="account.model_account_tax"/>
            <field name="model_domain_raw">[]</field>
        </record>

        <record id="pwa_cache_model_account_incoterms_all" model="pwa.cache">
            <field name="name">Account Incoterms (All)</field>
            <field name="cache_type">model</field>
            <field name="model_id" ref="account.model_account_incoterms"/>
            <field name="model_domain_raw">[]</field>
        </record>

        <record id="pwa_cache_model_account_payment_term_all" model="pwa.cache">
            <field name="name">Account Payment Term (All)</field>
            <field name="cache_type">model</field>
            <field name="model_id" ref="account.model_account_payment_term"/>
            <field name="model_domain_raw">[]</field>
        </record>

        <!-- ONCHANGE -->

        <function model="ir.model.data" name="_update_xmlids">
            <value model="base" eval="[{
                'xml_id': 'sale_pwa_cache.sale.order.field.partner_id',
                'record': obj().env['ir.model.fields'].search([('model_id', '=', obj().env.ref('sale.model_sale_order').id), ('name', '=', 'partner_id')], limit=1),
                'noupdate': False,
            },{
                'xml_id': 'sale_pwa_cache.sale.order.line.field.product_id',
                'record': obj().env['ir.model.fields'].search([('model_id', '=', obj().env.ref('sale.model_sale_order_line').id), ('name', '=', 'product_id')], limit=1),
                'noupdate': False,
            }]"/>
        </function>

        <record id="pwa_cache_onchange_sale_order_partern_id" model="pwa.cache">
            <field name="name">Sale Order - Onchange - partner_id (All partners modifed the last year)</field>
            <field name="cache_type">onchange</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="onchange_field" ref="sale_pwa_cache.sale.order.field.partner_id"/>
            <field name="code"><![CDATA[
partner_ids = env['res.partner'].search([['write_date', '>', (context_today() - relativedelta(days=365)).strftime('%Y-%m-%d')]])
params = [
    {
        'partner_id': id,
        'currency_id': False,
    } for id in partner_ids.ids]
            ]]></field>
        </record>

        <record id="pwa_cache_onchange_sale_order_line_product_id" model="pwa.cache">
            <field name="name">Sale Order Line - Onchange - product_id (All products per partners modifed the last year)</field>
            <field name="cache_type">onchange</field>
            <field name="model_id" ref="sale.model_sale_order_line"/>
            <field name="onchange_field" ref="sale_pwa_cache.sale.order.line.field.product_id"/>
            <field name="onchange_triggers">order_id.partner_id,order_id.pricelist_id</field>
            <field name="code"><![CDATA[
product_ids = env['product.product'].search([])
partner_ids = env['res.partner'].search([['write_date', '>', (context_today() - relativedelta(days=365)).strftime('%Y-%m-%d')]])
params = [
    {
        'product_id': product_id.id,
        'price_unit': None,
        'uom_category_id': None,
        'product_uom': None,
        'currency_id': None,
        'order_id': {
            'partner_id': partner_id.id,
            'currency_id': None,
            'pricelist_id': partner_id.property_product_pricelist and partner_id.property_product_pricelist.id or False,
        }
    } for product_id in product_ids for partner_id in partner_ids]
            ]]></field>
        </record>
    </data>
</odoo>
